require('source-map-support').install();

'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _this = this;

var _ = require('../..');

var _libUtils = require('../../lib/utils');

var _libUtils2 = _interopRequireDefault(_libUtils);

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

require('mochawait');

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

_chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

describe('android tools', function () {
  before(function callee$1$0() {
    var _spawn, _exec;

    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          _spawn = _libUtils2['default'].spawn;
          _exec = _libUtils2['default'].exec;

          _sinon2['default'].stub(_libUtils2['default'], "spawn", function () {
            return _spawn('sleep', ['300']);
          });
          _sinon2['default'].stub(_libUtils2['default'], "exec", function () {
            return _exec('echo 1');
          });

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('launch emu', function callee$1$0() {
    var emu;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          emu = undefined;
          context$2$0.prev = 1;

          emu = new _.AndroidEmulator('myavd', { initWait: 500 });
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(emu.start());

        case 5:
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(emu.waitTillReady());

        case 7:
          context$2$0.prev = 7;

          if (emu) emu.stop();
          return context$2$0.finish(7);

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this, [[1,, 7, 10]]);
  });

  it('killAll', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(_.androidTools.killAll());

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(_.androidTools.killAll('ls'));

        case 4:
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(_.androidTools.killAll(['ls', 'echo']));

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  after(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          _libUtils2['default'].spawn.restore();
          _libUtils2['default'].exec.restore();

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3Qvc3BlY3MvYW5kcm9pZC10b29sLXNwZWNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Z0JBRThDLE9BQU87O3dCQUNuQyxpQkFBaUI7Ozs7b0JBQ2xCLE1BQU07Ozs7OEJBQ0ksa0JBQWtCOzs7O1FBQ3RDLFdBQVc7O3FCQUNBLE9BQU87Ozs7QUFFekIsa0JBQUssTUFBTSxFQUFFLENBQUM7QUFDZCxrQkFBSyxHQUFHLDZCQUFnQixDQUFDOztBQUV6QixRQUFRLENBQUMsZUFBZSxFQUFFLFlBQU07QUFDOUIsUUFBTSxDQUFDO1FBQ0QsTUFBTSxFQUNOLEtBQUs7Ozs7O0FBREwsZ0JBQU0sR0FBRyxzQkFBTSxLQUFLO0FBQ3BCLGVBQUssR0FBRyxzQkFBTSxJQUFJOztBQUV0Qiw2QkFBTSxJQUFJLHdCQUFRLE9BQU8sRUFBRSxZQUFZO0FBQ3JDLG1CQUFPLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1dBQ2pDLENBQUMsQ0FBQztBQUNILDZCQUFNLElBQUksd0JBQVEsTUFBTSxFQUFFLFlBQVk7QUFDcEMsbUJBQU8sS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1dBQ3hCLENBQUMsQ0FBQzs7Ozs7OztHQUNKLENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsWUFBWSxFQUFDO1FBQ1YsR0FBRzs7OztBQUFILGFBQUc7OztBQUVMLGFBQUcsR0FBRyxzQkFBb0IsT0FBTyxFQUFFLEVBQUMsUUFBUSxFQUFFLEdBQUcsRUFBQyxDQUFDLENBQUM7OzJDQUM5QyxHQUFHLENBQUMsS0FBSyxFQUFFOzs7OzJDQUNYLEdBQUcsQ0FBQyxhQUFhLEVBQUU7Ozs7O0FBRXpCLGNBQUksR0FBRyxFQUFFLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQzs7Ozs7Ozs7R0FFdkIsQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQyxTQUFTLEVBQUM7Ozs7OzJDQUNMLGVBQWEsT0FBTyxFQUFFOzs7OzJDQUN0QixlQUFhLE9BQU8sQ0FBQyxJQUFJLENBQUM7Ozs7MkNBQzFCLGVBQWEsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDOzs7Ozs7O0dBQzNDLENBQUMsQ0FBQzs7QUFFSCxPQUFLLENBQUM7Ozs7QUFDSixnQ0FBTSxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDdEIsZ0NBQU0sSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDOzs7Ozs7O0dBQ3RCLENBQUMsQ0FBQztDQUVKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L3NwZWNzL2FuZHJvaWQtdG9vbC1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRyYW5zcGlsZTptb2NoYVxuXG5pbXBvcnQgeyBBbmRyb2lkRW11bGF0b3IsIGFuZHJvaWRUb29scyB9IGZyb20gJy4uLy4uJztcbmltcG9ydCB1dGlscyBmcm9tICcuLi8uLi9saWIvdXRpbHMnO1xuaW1wb3J0IGNoYWkgZnJvbSAnY2hhaSc7XG5pbXBvcnQgY2hhaUFzUHJvbWlzZWQgZnJvbSAnY2hhaS1hcy1wcm9taXNlZCc7XG5pbXBvcnQgJ21vY2hhd2FpdCc7XG5pbXBvcnQgc2lub24gZnJvbSAnc2lub24nO1xuXG5jaGFpLnNob3VsZCgpO1xuY2hhaS51c2UoY2hhaUFzUHJvbWlzZWQpO1xuXG5kZXNjcmliZSgnYW5kcm9pZCB0b29scycsICgpID0+IHtcbiAgYmVmb3JlKGFzeW5jICgpID0+IHtcbiAgICBsZXQgX3NwYXduID0gdXRpbHMuc3Bhd247XG4gICAgbGV0IF9leGVjID0gdXRpbHMuZXhlYztcblxuICAgIHNpbm9uLnN0dWIodXRpbHMsIFwic3Bhd25cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF9zcGF3bignc2xlZXAnLCBbJzMwMCddKTtcbiAgICB9KTtcbiAgICBzaW5vbi5zdHViKHV0aWxzLCBcImV4ZWNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF9leGVjKCdlY2hvIDEnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ2xhdW5jaCBlbXUnLGFzeW5jICgpID0+IHtcbiAgICBsZXQgZW11O1xuICAgIHRyeSB7XG4gICAgICBlbXUgPSBuZXcgQW5kcm9pZEVtdWxhdG9yKCdteWF2ZCcsIHtpbml0V2FpdDogNTAwfSk7XG4gICAgICBhd2FpdCBlbXUuc3RhcnQoKTtcbiAgICAgIGF3YWl0IGVtdS53YWl0VGlsbFJlYWR5KCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGlmIChlbXUpIGVtdS5zdG9wKCk7XG4gICAgfVxuICB9KTtcblxuICBpdCgna2lsbEFsbCcsYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGFuZHJvaWRUb29scy5raWxsQWxsKCk7XG4gICAgYXdhaXQgYW5kcm9pZFRvb2xzLmtpbGxBbGwoJ2xzJyk7XG4gICAgYXdhaXQgYW5kcm9pZFRvb2xzLmtpbGxBbGwoWydscycsICdlY2hvJ10pO1xuICB9KTtcblxuICBhZnRlcihhc3luYyAoKSA9PiB7XG4gICAgdXRpbHMuc3Bhd24ucmVzdG9yZSgpO1xuICAgIHV0aWxzLmV4ZWMucmVzdG9yZSgpO1xuICB9KTtcblxufSk7XG5cbiJdLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
