'use strict';

var _get = require('babel-runtime/helpers/get')['default'];

var _inherits = require('babel-runtime/helpers/inherits')['default'];

var _classCallCheck = require('babel-runtime/helpers/class-call-check')['default'];

var _createClass = require('babel-runtime/helpers/create-class')['default'];

var _getIterator = require('babel-runtime/core-js/get-iterator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _es6Error = require('es6-error');

var _es6Error2 = _interopRequireDefault(_es6Error);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _appiumSupport = require('appium-support');

var _httpStatusCodes = require('http-status-codes');

var _httpStatusCodes2 = _interopRequireDefault(_httpStatusCodes);

// base error class for all of our errors

var MJSONWPError = (function (_ES6Error) {
  _inherits(MJSONWPError, _ES6Error);

  function MJSONWPError(msg, jsonwpCode) {
    var w3cStatus = arguments.length <= 2 || arguments[2] === undefined ? 400 : arguments[2];

    _classCallCheck(this, MJSONWPError);

    _get(Object.getPrototypeOf(MJSONWPError.prototype), 'constructor', this).call(this, msg);
    this.jsonwpCode = jsonwpCode;
    if (this.jsonwpCode === null) {
      this.jsonwpCode = 13;
    }
    this.w3cStatus = w3cStatus;
  }

  return MJSONWPError;
})(_es6Error2['default']);

var NoSuchDriverError = (function (_MJSONWPError) {
  _inherits(NoSuchDriverError, _MJSONWPError);

  _createClass(NoSuchDriverError, null, [{
    key: 'code',
    value: function code() {
      return 6;
    }

    // W3C Error is called InvalidSessionID
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].NOT_FOUND;
    }
  }]);

  function NoSuchDriverError(err) {
    _classCallCheck(this, NoSuchDriverError);

    _get(Object.getPrototypeOf(NoSuchDriverError.prototype), 'constructor', this).call(this, err || 'A session is either terminated or not started', NoSuchDriverError.code(), NoSuchDriverError.w3cStatus());
  }

  return NoSuchDriverError;
})(MJSONWPError);

var NoSuchElementError = (function (_MJSONWPError2) {
  _inherits(NoSuchElementError, _MJSONWPError2);

  _createClass(NoSuchElementError, null, [{
    key: 'code',
    value: function code() {
      return 7;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].NOT_FOUND;
    }
  }]);

  function NoSuchElementError(err) {
    _classCallCheck(this, NoSuchElementError);

    _get(Object.getPrototypeOf(NoSuchElementError.prototype), 'constructor', this).call(this, err || 'An element could not be located on the page using the given ' + 'search parameters.', NoSuchElementError.code(), NoSuchElementError.w3cStatus());
  }

  return NoSuchElementError;
})(MJSONWPError);

var NoSuchFrameError = (function (_MJSONWPError3) {
  _inherits(NoSuchFrameError, _MJSONWPError3);

  _createClass(NoSuchFrameError, null, [{
    key: 'code',
    value: function code() {
      return 8;
    }
  }]);

  function NoSuchFrameError(err) {
    _classCallCheck(this, NoSuchFrameError);

    _get(Object.getPrototypeOf(NoSuchFrameError.prototype), 'constructor', this).call(this, err || 'A request to switch to a frame could not be satisfied because ' + 'the frame could not be found.', NoSuchFrameError.code());
  }

  return NoSuchFrameError;
})(MJSONWPError);

var UnknownCommandError = (function (_MJSONWPError4) {
  _inherits(UnknownCommandError, _MJSONWPError4);

  _createClass(UnknownCommandError, null, [{
    key: 'code',
    value: function code() {
      return 9;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].NOT_FOUND;
    }
  }]);

  function UnknownCommandError(err) {
    _classCallCheck(this, UnknownCommandError);

    _get(Object.getPrototypeOf(UnknownCommandError.prototype), 'constructor', this).call(this, err || 'The requested resource could not be found, or a request was ' + 'received using an HTTP method that is not supported by the mapped ' + 'resource.', UnknownCommandError.code(), UnknownCommandError.w3cStatus());
  }

  return UnknownCommandError;
})(MJSONWPError);

var StaleElementReferenceError = (function (_MJSONWPError5) {
  _inherits(StaleElementReferenceError, _MJSONWPError5);

  _createClass(StaleElementReferenceError, null, [{
    key: 'code',
    value: function code() {
      return 10;
    }
  }]);

  function StaleElementReferenceError(err) {
    _classCallCheck(this, StaleElementReferenceError);

    _get(Object.getPrototypeOf(StaleElementReferenceError.prototype), 'constructor', this).call(this, err || 'An element command failed because the referenced element is no ' + 'longer attached to the DOM.', StaleElementReferenceError.code());
  }

  return StaleElementReferenceError;
})(MJSONWPError);

var ElementNotVisibleError = (function (_MJSONWPError6) {
  _inherits(ElementNotVisibleError, _MJSONWPError6);

  _createClass(ElementNotVisibleError, null, [{
    key: 'code',
    value: function code() {
      return 11;
    }
  }]);

  function ElementNotVisibleError(err) {
    _classCallCheck(this, ElementNotVisibleError);

    _get(Object.getPrototypeOf(ElementNotVisibleError.prototype), 'constructor', this).call(this, err || 'An element command could not be completed because the element is ' + 'not visible on the page.', ElementNotVisibleError.code());
  }

  return ElementNotVisibleError;
})(MJSONWPError);

var InvalidElementStateError = (function (_MJSONWPError7) {
  _inherits(InvalidElementStateError, _MJSONWPError7);

  _createClass(InvalidElementStateError, null, [{
    key: 'code',
    value: function code() {
      return 12;
    }
  }]);

  function InvalidElementStateError(err) {
    _classCallCheck(this, InvalidElementStateError);

    _get(Object.getPrototypeOf(InvalidElementStateError.prototype), 'constructor', this).call(this, err || 'An element command could not be completed because the element is ' + 'in an invalid state (e.g. attempting to click a disabled element).', InvalidElementStateError.code());
  }

  return InvalidElementStateError;
})(MJSONWPError);

var UnknownError = (function (_MJSONWPError8) {
  _inherits(UnknownError, _MJSONWPError8);

  _createClass(UnknownError, null, [{
    key: 'code',
    value: function code() {
      return 13;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].INTERNAL_SERVER_ERROR;
    }
  }]);

  function UnknownError(originalError) {
    _classCallCheck(this, UnknownError);

    var origMessage = originalError;
    if (originalError instanceof Error) {
      origMessage = originalError.message;
    }
    var message = 'An unknown server-side error occurred while processing ' + 'the command.';
    if (originalError) {
      message = message + ' Original error: ' + origMessage;
    }

    _get(Object.getPrototypeOf(UnknownError.prototype), 'constructor', this).call(this, message, UnknownError.code(), UnknownError.w3cStatus());
  }

  return UnknownError;
})(MJSONWPError);

var UnknownMethodError = (function (_MJSONWPError9) {
  _inherits(UnknownMethodError, _MJSONWPError9);

  _createClass(UnknownMethodError, null, [{
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].METHOD_NOT_ALLOWED;
    }
  }]);

  function UnknownMethodError(err) {
    _classCallCheck(this, UnknownMethodError);

    _get(Object.getPrototypeOf(UnknownMethodError.prototype), 'constructor', this).call(this, err || 'Unknown method.', null, UnknownMethodError.w3cStatus());
  }

  return UnknownMethodError;
})(MJSONWPError);

var UnsupportedOperationError = (function (_MJSONWPError10) {
  _inherits(UnsupportedOperationError, _MJSONWPError10);

  _createClass(UnsupportedOperationError, null, [{
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].INTERNAL_SERVER_ERROR;
    }
  }]);

  function UnsupportedOperationError(err) {
    _classCallCheck(this, UnsupportedOperationError);

    _get(Object.getPrototypeOf(UnsupportedOperationError.prototype), 'constructor', this).call(this, err || 'A server-side error occurred. Command cannot be supported.', null, UnsupportedOperationError.w3cStatus());
  }

  return UnsupportedOperationError;
})(MJSONWPError);

var ElementIsNotSelectableError = (function (_MJSONWPError11) {
  _inherits(ElementIsNotSelectableError, _MJSONWPError11);

  _createClass(ElementIsNotSelectableError, null, [{
    key: 'code',
    value: function code() {
      return 15;
    }
  }]);

  function ElementIsNotSelectableError(err) {
    _classCallCheck(this, ElementIsNotSelectableError);

    _get(Object.getPrototypeOf(ElementIsNotSelectableError.prototype), 'constructor', this).call(this, err || 'An attempt was made to select an element that cannot be selected.', ElementIsNotSelectableError.code());
  }

  return ElementIsNotSelectableError;
})(MJSONWPError);

var JavaScriptError = (function (_MJSONWPError12) {
  _inherits(JavaScriptError, _MJSONWPError12);

  _createClass(JavaScriptError, null, [{
    key: 'code',
    value: function code() {
      return 17;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return 500;
    }
  }]);

  function JavaScriptError(err) {
    _classCallCheck(this, JavaScriptError);

    _get(Object.getPrototypeOf(JavaScriptError.prototype), 'constructor', this).call(this, err || 'An error occurred while executing user supplied JavaScript.', JavaScriptError.code(), JavaScriptError.w3cStatus());
  }

  return JavaScriptError;
})(MJSONWPError);

var XPathLookupError = (function (_MJSONWPError13) {
  _inherits(XPathLookupError, _MJSONWPError13);

  _createClass(XPathLookupError, null, [{
    key: 'code',
    value: function code() {
      return 19;
    }
  }]);

  function XPathLookupError(err) {
    _classCallCheck(this, XPathLookupError);

    _get(Object.getPrototypeOf(XPathLookupError.prototype), 'constructor', this).call(this, err || 'An error occurred while searching for an element by XPath.', XPathLookupError.code());
  }

  return XPathLookupError;
})(MJSONWPError);

var TimeoutError = (function (_MJSONWPError14) {
  _inherits(TimeoutError, _MJSONWPError14);

  _createClass(TimeoutError, null, [{
    key: 'code',
    value: function code() {
      return 21;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].REQUEST_TIMEOUT;
    }
  }]);

  function TimeoutError(err) {
    _classCallCheck(this, TimeoutError);

    _get(Object.getPrototypeOf(TimeoutError.prototype), 'constructor', this).call(this, err || 'An operation did not complete before its timeout expired.', TimeoutError.code(), TimeoutError.w3cStatus());
  }

  return TimeoutError;
})(MJSONWPError);

var NoSuchWindowError = (function (_MJSONWPError15) {
  _inherits(NoSuchWindowError, _MJSONWPError15);

  _createClass(NoSuchWindowError, null, [{
    key: 'code',
    value: function code() {
      return 23;
    }
  }]);

  function NoSuchWindowError(err) {
    _classCallCheck(this, NoSuchWindowError);

    _get(Object.getPrototypeOf(NoSuchWindowError.prototype), 'constructor', this).call(this, err || 'A request to switch to a different window could not be satisfied ' + 'because the window could not be found.', NoSuchWindowError.code());
  }

  return NoSuchWindowError;
})(MJSONWPError);

var InvalidCookieDomainError = (function (_MJSONWPError16) {
  _inherits(InvalidCookieDomainError, _MJSONWPError16);

  _createClass(InvalidCookieDomainError, null, [{
    key: 'code',
    value: function code() {
      return 24;
    }
  }]);

  function InvalidCookieDomainError(err) {
    _classCallCheck(this, InvalidCookieDomainError);

    _get(Object.getPrototypeOf(InvalidCookieDomainError.prototype), 'constructor', this).call(this, err || 'An illegal attempt was made to set a cookie under a different ' + 'domain than the current page.', InvalidCookieDomainError.code());
  }

  return InvalidCookieDomainError;
})(MJSONWPError);

var NoSuchCookieError = (function (_MJSONWPError17) {
  _inherits(NoSuchCookieError, _MJSONWPError17);

  _createClass(NoSuchCookieError, null, [{
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].NOT_FOUND;
    }
  }]);

  function NoSuchCookieError(err) {
    _classCallCheck(this, NoSuchCookieError);

    _get(Object.getPrototypeOf(NoSuchCookieError.prototype), 'constructor', this).call(this, err || 'Could not find cookie', null, NoSuchCookieError.w3cStatus());
  }

  return NoSuchCookieError;
})(MJSONWPError);

var UnableToSetCookieError = (function (_MJSONWPError18) {
  _inherits(UnableToSetCookieError, _MJSONWPError18);

  _createClass(UnableToSetCookieError, null, [{
    key: 'code',
    value: function code() {
      return 25;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].INTERNAL_SERVER_ERROR;
    }
  }]);

  function UnableToSetCookieError(err) {
    _classCallCheck(this, UnableToSetCookieError);

    _get(Object.getPrototypeOf(UnableToSetCookieError.prototype), 'constructor', this).call(this, err || 'A request to set a cookie\'s value could not be satisfied.', UnableToSetCookieError.code(), UnableToSetCookieError.w3cStatus());
  }

  return UnableToSetCookieError;
})(MJSONWPError);

var UnexpectedAlertOpenError = (function (_MJSONWPError19) {
  _inherits(UnexpectedAlertOpenError, _MJSONWPError19);

  _createClass(UnexpectedAlertOpenError, null, [{
    key: 'code',
    value: function code() {
      return 26;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].INTERNAL_SERVER_ERROR;
    }
  }]);

  function UnexpectedAlertOpenError(err) {
    _classCallCheck(this, UnexpectedAlertOpenError);

    _get(Object.getPrototypeOf(UnexpectedAlertOpenError.prototype), 'constructor', this).call(this, err || 'A modal dialog was open, blocking this operation', UnexpectedAlertOpenError.code(), UnexpectedAlertOpenError.w3cStatus());
  }

  return UnexpectedAlertOpenError;
})(MJSONWPError);

var NoAlertOpenError = (function (_MJSONWPError20) {
  _inherits(NoAlertOpenError, _MJSONWPError20);

  _createClass(NoAlertOpenError, null, [{
    key: 'code',
    value: function code() {
      return 27;
    }
  }]);

  function NoAlertOpenError(err) {
    _classCallCheck(this, NoAlertOpenError);

    _get(Object.getPrototypeOf(NoAlertOpenError.prototype), 'constructor', this).call(this, err || 'An attempt was made to operate on a modal dialog when one ' + 'was not open.', NoAlertOpenError.code());
  }

  return NoAlertOpenError;
})(MJSONWPError);

var ScriptTimeoutError = (function (_MJSONWPError21) {
  _inherits(ScriptTimeoutError, _MJSONWPError21);

  _createClass(ScriptTimeoutError, null, [{
    key: 'code',
    value: function code() {
      return 28;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].REQUEST_TIMEOUT;
    }
  }]);

  function ScriptTimeoutError(err) {
    _classCallCheck(this, ScriptTimeoutError);

    _get(Object.getPrototypeOf(ScriptTimeoutError.prototype), 'constructor', this).call(this, err || 'A script did not complete before its timeout expired.', ScriptTimeoutError.code(), ScriptTimeoutError.w3cStatus());
  }

  return ScriptTimeoutError;
})(MJSONWPError);

var InvalidElementCoordinatesError = (function (_MJSONWPError22) {
  _inherits(InvalidElementCoordinatesError, _MJSONWPError22);

  _createClass(InvalidElementCoordinatesError, null, [{
    key: 'code',
    value: function code() {
      return 29;
    }
  }]);

  function InvalidElementCoordinatesError(err) {
    _classCallCheck(this, InvalidElementCoordinatesError);

    _get(Object.getPrototypeOf(InvalidElementCoordinatesError.prototype), 'constructor', this).call(this, err || 'The coordinates provided to an interactions operation are invalid.', InvalidElementCoordinatesError.code());
  }

  return InvalidElementCoordinatesError;
})(MJSONWPError);

var IMENotAvailableError = (function (_MJSONWPError23) {
  _inherits(IMENotAvailableError, _MJSONWPError23);

  _createClass(IMENotAvailableError, null, [{
    key: 'code',
    value: function code() {
      return 30;
    }
  }]);

  function IMENotAvailableError(err) {
    _classCallCheck(this, IMENotAvailableError);

    _get(Object.getPrototypeOf(IMENotAvailableError.prototype), 'constructor', this).call(this, err || 'IME was not available.', IMENotAvailableError.code());
  }

  return IMENotAvailableError;
})(MJSONWPError);

var IMEEngineActivationFailedError = (function (_MJSONWPError24) {
  _inherits(IMEEngineActivationFailedError, _MJSONWPError24);

  _createClass(IMEEngineActivationFailedError, null, [{
    key: 'code',
    value: function code() {
      return 31;
    }
  }]);

  function IMEEngineActivationFailedError(err) {
    _classCallCheck(this, IMEEngineActivationFailedError);

    _get(Object.getPrototypeOf(IMEEngineActivationFailedError.prototype), 'constructor', this).call(this, err || 'An IME engine could not be started.', IMEEngineActivationFailedError.code());
  }

  return IMEEngineActivationFailedError;
})(MJSONWPError);

var InvalidSelectorError = (function (_MJSONWPError25) {
  _inherits(InvalidSelectorError, _MJSONWPError25);

  _createClass(InvalidSelectorError, null, [{
    key: 'code',
    value: function code() {
      return 32;
    }
  }]);

  function InvalidSelectorError(err) {
    _classCallCheck(this, InvalidSelectorError);

    _get(Object.getPrototypeOf(InvalidSelectorError.prototype), 'constructor', this).call(this, err || 'Argument was an invalid selector (e.g. XPath/CSS).', InvalidSelectorError.code());
  }

  return InvalidSelectorError;
})(MJSONWPError);

var SessionNotCreatedError = (function (_MJSONWPError26) {
  _inherits(SessionNotCreatedError, _MJSONWPError26);

  _createClass(SessionNotCreatedError, null, [{
    key: 'code',
    value: function code() {
      return 33;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].INTERNAL_SERVER_ERROR;
    }
  }]);

  function SessionNotCreatedError(details) {
    _classCallCheck(this, SessionNotCreatedError);

    var message = 'A new session could not be created.';
    if (details) {
      message += ' Details: ' + details;
    }

    _get(Object.getPrototypeOf(SessionNotCreatedError.prototype), 'constructor', this).call(this, message, SessionNotCreatedError.code(), SessionNotCreatedError.w3cStatus());
  }

  return SessionNotCreatedError;
})(MJSONWPError);

var MoveTargetOutOfBoundsError = (function (_MJSONWPError27) {
  _inherits(MoveTargetOutOfBoundsError, _MJSONWPError27);

  _createClass(MoveTargetOutOfBoundsError, null, [{
    key: 'code',
    value: function code() {
      return 34;
    }
  }, {
    key: 'w3cStatus',
    value: function w3cStatus() {
      return 500;
    }
  }]);

  function MoveTargetOutOfBoundsError(err) {
    _classCallCheck(this, MoveTargetOutOfBoundsError);

    _get(Object.getPrototypeOf(MoveTargetOutOfBoundsError.prototype), 'constructor', this).call(this, err || 'Target provided for a move action is out of bounds.', MoveTargetOutOfBoundsError.code(), MoveTargetOutOfBoundsError.w3cStatus());
  }

  return MoveTargetOutOfBoundsError;
})(MJSONWPError);

var NoSuchContextError = (function (_MJSONWPError28) {
  _inherits(NoSuchContextError, _MJSONWPError28);

  _createClass(NoSuchContextError, null, [{
    key: 'code',
    value: function code() {
      return 35;
    }
  }]);

  function NoSuchContextError(err) {
    _classCallCheck(this, NoSuchContextError);

    _get(Object.getPrototypeOf(NoSuchContextError.prototype), 'constructor', this).call(this, err || 'No such context found.', NoSuchContextError.code());
  }

  return NoSuchContextError;
})(MJSONWPError);

var InvalidContextError = (function (_MJSONWPError29) {
  _inherits(InvalidContextError, _MJSONWPError29);

  _createClass(InvalidContextError, null, [{
    key: 'code',
    value: function code() {
      return 36;
    }
  }]);

  function InvalidContextError(err) {
    _classCallCheck(this, InvalidContextError);

    _get(Object.getPrototypeOf(InvalidContextError.prototype), 'constructor', this).call(this, err || 'That command could not be executed in the current context.', InvalidContextError.code());
  }

  return InvalidContextError;
})(MJSONWPError);

var NotYetImplementedError = (function (_MJSONWPError30) {
  _inherits(NotYetImplementedError, _MJSONWPError30);

  _createClass(NotYetImplementedError, null, [{
    key: 'code',
    value: function code() {
      return 13;
    }
  }]);

  function NotYetImplementedError(err) {
    _classCallCheck(this, NotYetImplementedError);

    _get(Object.getPrototypeOf(NotYetImplementedError.prototype), 'constructor', this).call(this, err || 'Method has not yet been implemented', NotYetImplementedError.code());
  }

  return NotYetImplementedError;
})(MJSONWPError);

var NotImplementedError = (function (_MJSONWPError31) {
  _inherits(NotImplementedError, _MJSONWPError31);

  _createClass(NotImplementedError, null, [{
    key: 'code',
    value: function code() {
      return 13;
    }
  }]);

  function NotImplementedError(err) {
    _classCallCheck(this, NotImplementedError);

    _get(Object.getPrototypeOf(NotImplementedError.prototype), 'constructor', this).call(this, err || 'Method is not implemented', NotImplementedError.code());
  }

  return NotImplementedError;
})(MJSONWPError);

var UnableToCaptureScreen = (function (_MJSONWPError32) {
  _inherits(UnableToCaptureScreen, _MJSONWPError32);

  _createClass(UnableToCaptureScreen, null, [{
    key: 'w3cStatus',
    value: function w3cStatus() {
      return _httpStatusCodes2['default'].INTERNAL_SERVER_ERROR;
    }
  }]);

  function UnableToCaptureScreen(err) {
    _classCallCheck(this, UnableToCaptureScreen);

    _get(Object.getPrototypeOf(UnableToCaptureScreen.prototype), 'constructor', this).call(this, err || 'Unable to capture screen', null, UnableToCaptureScreen.w3cStatus());
  }

  return UnableToCaptureScreen;
})(MJSONWPError);

var BadParametersError = (function (_ES6Error2) {
  _inherits(BadParametersError, _ES6Error2);

  function BadParametersError(requiredParams, actualParams, errMessage) {
    _classCallCheck(this, BadParametersError);

    var message = undefined;
    if (!errMessage) {
      message = 'Parameters were incorrect. We wanted ' + (JSON.stringify(requiredParams) + ' and you ') + ('sent ' + JSON.stringify(actualParams));
    } else {
      message = 'Parameters were incorrect. You sent ' + JSON.stringify(actualParams) + ', ' + errMessage;
    }
    _get(Object.getPrototypeOf(BadParametersError.prototype), 'constructor', this).call(this, message);
    this.w3cStatus = _httpStatusCodes2['default'].BAD_REQUEST;
  }

  /**
   * ProxyRequestError is a custom error and will be thrown up on unsuccessful proxy request and
   * will contain information about the proxy failure.
   * In case of ProxyRequestError should fetch the actual error by calling `getActualError()`
   * for proxy failure to generate the client response.
   */
  return BadParametersError;
})(_es6Error2['default']);

var ProxyRequestError = (function (_ES6Error3) {
  _inherits(ProxyRequestError, _ES6Error3);

  function ProxyRequestError(err, jsonwp) {
    _classCallCheck(this, ProxyRequestError);

    var message = 'Proxy request unsuccessful. ' + (_appiumSupport.util.hasValue(jsonwp) ? jsonwp.value : '');
    _get(Object.getPrototypeOf(ProxyRequestError.prototype), 'constructor', this).call(this, err || message);
    this.w3cStatus = _httpStatusCodes2['default'].BAD_REQUEST;
    if (typeof jsonwp === 'string') {
      this.jsonwp = JSON.parse(jsonwp);
    } else {
      this.jsonwp = jsonwp;
    }
  }

  // map of error class name to error class

  _createClass(ProxyRequestError, [{
    key: 'getActualError',
    value: function getActualError() {
      if (_appiumSupport.util.hasValue(this.jsonwp) && _appiumSupport.util.hasValue(this.jsonwp.status) && _appiumSupport.util.hasValue(this.jsonwp.value)) {
        //returns actual error cause for request failure based on `jsonwp.status`
        return errorFromCode(this.jsonwp.status, this.jsonwp.value);
      }
      return new UnknownError(this.message);
    }
  }]);

  return ProxyRequestError;
})(_es6Error2['default']);

var errors = { NotYetImplementedError: NotYetImplementedError,
  NotImplementedError: NotImplementedError,
  BadParametersError: BadParametersError,
  NoSuchDriverError: NoSuchDriverError,
  NoSuchElementError: NoSuchElementError,
  UnknownCommandError: UnknownCommandError,
  StaleElementReferenceError: StaleElementReferenceError,
  ElementNotVisibleError: ElementNotVisibleError,
  InvalidElementStateError: InvalidElementStateError,
  UnknownError: UnknownError,
  ElementIsNotSelectableError: ElementIsNotSelectableError,
  JavaScriptError: JavaScriptError,
  XPathLookupError: XPathLookupError,
  TimeoutError: TimeoutError,
  NoSuchWindowError: NoSuchWindowError,
  NoSuchCookieError: NoSuchCookieError,
  InvalidCookieDomainError: InvalidCookieDomainError,
  UnableToSetCookieError: UnableToSetCookieError,
  UnexpectedAlertOpenError: UnexpectedAlertOpenError,
  NoAlertOpenError: NoAlertOpenError,
  ScriptTimeoutError: ScriptTimeoutError,
  InvalidElementCoordinatesError: InvalidElementCoordinatesError,
  IMENotAvailableError: IMENotAvailableError,
  IMEEngineActivationFailedError: IMEEngineActivationFailedError,
  InvalidSelectorError: InvalidSelectorError,
  SessionNotCreatedError: SessionNotCreatedError,
  MoveTargetOutOfBoundsError: MoveTargetOutOfBoundsError,
  NoSuchContextError: NoSuchContextError,
  InvalidContextError: InvalidContextError,
  NoSuchFrameError: NoSuchFrameError,
  UnableToCaptureScreen: UnableToCaptureScreen,
  UnknownMethodError: UnknownMethodError,
  UnsupportedOperationError: UnsupportedOperationError,
  ProxyRequestError: ProxyRequestError };

// map of error code to error class
var errorCodeMap = {};
var _iteratorNormalCompletion = true;
var _didIteratorError = false;
var _iteratorError = undefined;

try {
  for (var _iterator = _getIterator(_lodash2['default'].values(errors)), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
    var ErrorClass = _step.value;

    if (ErrorClass.code) {
      errorCodeMap[ErrorClass.code()] = ErrorClass;
    }
  }
} catch (err) {
  _didIteratorError = true;
  _iteratorError = err;
} finally {
  try {
    if (!_iteratorNormalCompletion && _iterator['return']) {
      _iterator['return']();
    }
  } finally {
    if (_didIteratorError) {
      throw _iteratorError;
    }
  }
}

function isErrorType(err, type) {
  // `name` property is the constructor name
  if (type.name === MJSONWPError.name) {
    // `jsonwpCode` is `0` on success
    return !!err.jsonwpCode;
  } else if (type.name === ProxyRequestError.name) {
    // `status` is `0` on success
    var hasJsonwpObj = !!err.jsonwp;
    if (hasJsonwpObj) {
      return !!err.jsonwp.status;
    } else {
      return false;
    }
  }
  return err.constructor.name === type.name;
}

// retrieve an error with the code and message
function errorFromCode(code, message) {
  if (code !== 13 && errorCodeMap[code]) {
    return new errorCodeMap[code](message);
  }
  return new UnknownError(message);
}

exports.MJSONWPError = MJSONWPError;
exports.errors = errors;
exports.isErrorType = isErrorType;
exports.errorFromCode = errorFromCode;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9tanNvbndwL2Vycm9ycy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7d0JBQXFCLFdBQVc7Ozs7c0JBQ2xCLFFBQVE7Ozs7NkJBQ0QsZ0JBQWdCOzsrQkFDVCxtQkFBbUI7Ozs7OztJQUd6QyxZQUFZO1lBQVosWUFBWTs7QUFDSixXQURSLFlBQVksQ0FDSCxHQUFHLEVBQUUsVUFBVSxFQUFtQjtRQUFqQixTQUFTLHlEQUFHLEdBQUc7OzBCQUR6QyxZQUFZOztBQUVkLCtCQUZFLFlBQVksNkNBRVIsR0FBRyxFQUFFO0FBQ1gsUUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7QUFDN0IsUUFBSSxJQUFJLENBQUMsVUFBVSxLQUFLLElBQUksRUFBRTtBQUM1QixVQUFJLENBQUMsVUFBVSxHQUFHLEVBQUUsQ0FBQztLQUN0QjtBQUNELFFBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO0dBQzVCOztTQVJHLFlBQVk7OztJQVdaLGlCQUFpQjtZQUFqQixpQkFBaUI7O2VBQWpCLGlCQUFpQjs7V0FDVCxnQkFBRztBQUNiLGFBQU8sQ0FBQyxDQUFDO0tBQ1Y7Ozs7O1dBRWdCLHFCQUFHO0FBQ2xCLGFBQU8sNkJBQWdCLFNBQVMsQ0FBQztLQUNsQzs7O0FBQ1csV0FSUixpQkFBaUIsQ0FRUixHQUFHLEVBQUU7MEJBUmQsaUJBQWlCOztBQVNuQiwrQkFURSxpQkFBaUIsNkNBU2IsR0FBRyxJQUFJLCtDQUErQyxFQUFFLGlCQUFpQixDQUFDLElBQUksRUFBRSxFQUFFLGlCQUFpQixDQUFDLFNBQVMsRUFBRSxFQUFFO0dBQ3hIOztTQVZHLGlCQUFpQjtHQUFTLFlBQVk7O0lBYXRDLGtCQUFrQjtZQUFsQixrQkFBa0I7O2VBQWxCLGtCQUFrQjs7V0FDVixnQkFBRztBQUNiLGFBQU8sQ0FBQyxDQUFDO0tBQ1Y7OztXQUNnQixxQkFBRztBQUNsQixhQUFPLDZCQUFnQixTQUFTLENBQUM7S0FDbEM7OztBQUNXLFdBUFIsa0JB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QU0sQ0FBQztLQUM1QixNQUFNO0FBQ0wsYUFBTyxLQUFLLENBQUM7S0FDZDtHQUNGO0FBQ0QsU0FBTyxHQUFHLENBQUMsV0FBVyxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDO0NBQzNDOzs7QUFHRCxTQUFTLGFBQWEsQ0FBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO0FBQ3JDLE1BQUksSUFBSSxLQUFLLEVBQUUsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDckMsV0FBTyxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQztHQUN4QztBQUNELFNBQU8sSUFBSSxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUM7Q0FDbEM7O1FBRVEsWUFBWSxHQUFaLFlBQVk7UUFBRSxNQUFNLEdBQU4sTUFBTTtRQUFFLFdBQVcsR0FBWCxXQUFXO1FBQUUsYUFBYSxHQUFiLGFBQWEiLCJmaWxlIjoibGliL21qc29ud3AvZXJyb3JzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEVTNkVycm9yIGZyb20gJ2VzNi1lcnJvcic7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgdXRpbCB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcbmltcG9ydCBIVFRQU3RhdHVzQ29kZXMgZnJvbSAnaHR0cC1zdGF0dXMtY29kZXMnO1xuXG4vLyBiYXNlIGVycm9yIGNsYXNzIGZvciBhbGwgb2Ygb3VyIGVycm9yc1xuY2xhc3MgTUpTT05XUEVycm9yIGV4dGVuZHMgRVM2RXJyb3Ige1xuICBjb25zdHJ1Y3RvciAobXNnLCBqc29ud3BDb2RlLCB3M2NTdGF0dXMgPSA0MDApIHtcbiAgICBzdXBlcihtc2cpO1xuICAgIHRoaXMuanNvbndwQ29kZSA9IGpzb253cENvZGU7XG4gICAgaWYgKHRoaXMuanNvbndwQ29kZSA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5qc29ud3BDb2RlID0gMTM7XG4gICAgfVxuICAgIHRoaXMudzNjU3RhdHVzID0gdzNjU3RhdHVzO1xuICB9XG59XG5cbmNsYXNzIE5vU3VjaERyaXZlckVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiA2O1xuICB9XG4gIC8vIFczQyBFcnJvciBpcyBjYWxsZWQgSW52YWxpZFNlc3Npb25JRFxuICBzdGF0aWMgdzNjU3RhdHVzICgpIHtcbiAgICByZXR1cm4gSFRUUFN0YXR1c0NvZGVzLk5PVF9GT1VORDtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBIHNlc3Npb24gaXMgZWl0aGVyIHRlcm1pbmF0ZWQgb3Igbm90IHN0YXJ0ZWQnLCBOb1N1Y2hEcml2ZXJFcnJvci5jb2RlKCksIE5vU3VjaERyaXZlckVycm9yLnczY1N0YXR1cygpKTtcbiAgfVxufVxuXG5jbGFzcyBOb1N1Y2hFbGVtZW50RXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDc7XG4gIH1cbiAgc3RhdGljIHczY1N0YXR1cyAoKSB7XG4gICAgcmV0dXJuIEhUVFBTdGF0dXNDb2Rlcy5OT1RfRk9VTkQ7XG4gIH1cbiAgY29uc3RydWN0b3IgKGVycikge1xuICAgIHN1cGVyKGVyciB8fCAnQW4gZWxlbWVudCBjb3VsZCBub3QgYmUgbG9jYXRlZCBvbiB0aGUgcGFnZSB1c2luZyB0aGUgZ2l2ZW4gJyArXG4gICAgICAgICAgJ3NlYXJjaCBwYXJhbWV0ZXJzLicsIE5vU3VjaEVsZW1lbnRFcnJvci5jb2RlKCksIE5vU3VjaEVsZW1lbnRFcnJvci53M2NTdGF0dXMoKSk7XG4gIH1cbn1cblxuY2xhc3MgTm9TdWNoRnJhbWVFcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyBjb2RlICgpIHtcbiAgICByZXR1cm4gODtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBIHJlcXVlc3QgdG8gc3dpdGNoIHRvIGEgZnJhbWUgY291bGQgbm90IGJlIHNhdGlzZmllZCBiZWNhdXNlICcgK1xuICAgICAgICAgICd0aGUgZnJhbWUgY291bGQgbm90IGJlIGZvdW5kLicsIE5vU3VjaEZyYW1lRXJyb3IuY29kZSgpKTtcbiAgfVxufVxuXG5jbGFzcyBVbmtub3duQ29tbWFuZEVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiA5O1xuICB9XG4gIHN0YXRpYyB3M2NTdGF0dXMgKCkge1xuICAgIHJldHVybiBIVFRQU3RhdHVzQ29kZXMuTk9UX0ZPVU5EO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ1RoZSByZXF1ZXN0ZWQgcmVzb3VyY2UgY291bGQgbm90IGJlIGZvdW5kLCBvciBhIHJlcXVlc3Qgd2FzICcgK1xuICAgICAgICAgICdyZWNlaXZlZCB1c2luZyBhbiBIVFRQIG1ldGhvZCB0aGF0IGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIG1hcHBlZCAnICtcbiAgICAgICAgICAncmVzb3VyY2UuJywgVW5rbm93bkNvbW1hbmRFcnJvci5jb2RlKCksIFVua25vd25Db21tYW5kRXJyb3IudzNjU3RhdHVzKCkpO1xuICB9XG59XG5cbmNsYXNzIFN0YWxlRWxlbWVudFJlZmVyZW5jZUVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAxMDtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBbiBlbGVtZW50IGNvbW1hbmQgZmFpbGVkIGJlY2F1c2UgdGhlIHJlZmVyZW5jZWQgZWxlbWVudCBpcyBubyAnICtcbiAgICAgICAgICAnbG9uZ2VyIGF0dGFjaGVkIHRvIHRoZSBET00uJywgU3RhbGVFbGVtZW50UmVmZXJlbmNlRXJyb3IuY29kZSgpKTtcbiAgfVxufVxuXG5jbGFzcyBFbGVtZW50Tm90VmlzaWJsZUVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAxMTtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBbiBlbGVtZW50IGNvbW1hbmQgY291bGQgbm90IGJlIGNvbXBsZXRlZCBiZWNhdXNlIHRoZSBlbGVtZW50IGlzICcgK1xuICAgICAgICAgICdub3QgdmlzaWJsZSBvbiB0aGUgcGFnZS4nLCBFbGVtZW50Tm90VmlzaWJsZUVycm9yLmNvZGUoKSk7XG4gIH1cbn1cblxuY2xhc3MgSW52YWxpZEVsZW1lbnRTdGF0ZUVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAxMjtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBbiBlbGVtZW50IGNvbW1hbmQgY291bGQgbm90IGJlIGNvbXBsZXRlZCBiZWNhdXNlIHRoZSBlbGVtZW50IGlzICcgK1xuICAgICAgICAgICdpbiBhbiBpbnZhbGlkIHN0YXRlIChlLmcuIGF0dGVtcHRpbmcgdG8gY2xpY2sgYSBkaXNhYmxlZCBlbGVtZW50KS4nLFxuICAgICAgICAgIEludmFsaWRFbGVtZW50U3RhdGVFcnJvci5jb2RlKCkpO1xuICB9XG59XG5cbmNsYXNzIFVua25vd25FcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyBjb2RlICgpIHtcbiAgICByZXR1cm4gMTM7XG4gIH1cbiAgc3RhdGljIHczY1N0YXR1cyAoKSB7XG4gICAgcmV0dXJuIEhUVFBTdGF0dXNDb2Rlcy5JTlRFUk5BTF9TRVJWRVJfRVJST1I7XG4gIH1cbiAgY29uc3RydWN0b3IgKG9yaWdpbmFsRXJyb3IpIHtcbiAgICBsZXQgb3JpZ01lc3NhZ2UgPSBvcmlnaW5hbEVycm9yO1xuICAgIGlmIChvcmlnaW5hbEVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIG9yaWdNZXNzYWdlID0gb3JpZ2luYWxFcnJvci5tZXNzYWdlO1xuICAgIH1cbiAgICBsZXQgbWVzc2FnZSA9ICdBbiB1bmtub3duIHNlcnZlci1zaWRlIGVycm9yIG9jY3VycmVkIHdoaWxlIHByb2Nlc3NpbmcgJyArXG4gICAgICAgICAgICAgICAgICAndGhlIGNvbW1hbmQuJztcbiAgICBpZiAob3JpZ2luYWxFcnJvcikge1xuICAgICAgbWVzc2FnZSA9IGAke21lc3NhZ2V9IE9yaWdpbmFsIGVycm9yOiAke29yaWdNZXNzYWdlfWA7XG4gICAgfVxuXG4gICAgc3VwZXIobWVzc2FnZSwgVW5rbm93bkVycm9yLmNvZGUoKSwgVW5rbm93bkVycm9yLnczY1N0YXR1cygpKTtcbiAgfVxufVxuXG5jbGFzcyBVbmtub3duTWV0aG9kRXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgdzNjU3RhdHVzICgpIHtcbiAgICByZXR1cm4gSFRUUFN0YXR1c0NvZGVzLk1FVEhPRF9OT1RfQUxMT1dFRDtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdVbmtub3duIG1ldGhvZC4nLCBudWxsLCBVbmtub3duTWV0aG9kRXJyb3IudzNjU3RhdHVzKCkpO1xuICB9XG59XG5cbmNsYXNzIFVuc3VwcG9ydGVkT3BlcmF0aW9uRXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgdzNjU3RhdHVzICgpIHtcbiAgICByZXR1cm4gSFRUUFN0YXR1c0NvZGVzLklOVEVSTkFMX1NFUlZFUl9FUlJPUjtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBIHNlcnZlci1zaWRlIGVycm9yIG9jY3VycmVkLiBDb21tYW5kIGNhbm5vdCBiZSBzdXBwb3J0ZWQuJywgbnVsbCwgVW5zdXBwb3J0ZWRPcGVyYXRpb25FcnJvci53M2NTdGF0dXMoKSk7XG4gIH1cbn1cblxuY2xhc3MgRWxlbWVudElzTm90U2VsZWN0YWJsZUVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAxNTtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBbiBhdHRlbXB0IHdhcyBtYWRlIHRvIHNlbGVjdCBhbiBlbGVtZW50IHRoYXQgY2Fubm90IGJlIHNlbGVjdGVkLicsXG4gICAgICAgICAgRWxlbWVudElzTm90U2VsZWN0YWJsZUVycm9yLmNvZGUoKSk7XG4gIH1cbn1cblxuY2xhc3MgSmF2YVNjcmlwdEVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAxNztcbiAgfVxuICBzdGF0aWMgdzNjU3RhdHVzICgpIHtcbiAgICByZXR1cm4gNTAwO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGV4ZWN1dGluZyB1c2VyIHN1cHBsaWVkIEphdmFTY3JpcHQuJyxcbiAgICAgICAgICBKYXZhU2NyaXB0RXJyb3IuY29kZSgpLCBKYXZhU2NyaXB0RXJyb3IudzNjU3RhdHVzKCkpO1xuICB9XG59XG5cbmNsYXNzIFhQYXRoTG9va3VwRXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDE5O1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIHNlYXJjaGluZyBmb3IgYW4gZWxlbWVudCBieSBYUGF0aC4nLFxuICAgICAgICAgIFhQYXRoTG9va3VwRXJyb3IuY29kZSgpKTtcbiAgfVxufVxuXG5jbGFzcyBUaW1lb3V0RXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDIxO1xuICB9XG4gIHN0YXRpYyB3M2NTdGF0dXMgKCkge1xuICAgIHJldHVybiBIVFRQU3RhdHVzQ29kZXMuUkVRVUVTVF9USU1FT1VUO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ0FuIG9wZXJhdGlvbiBkaWQgbm90IGNvbXBsZXRlIGJlZm9yZSBpdHMgdGltZW91dCBleHBpcmVkLicsXG4gICAgICAgICAgVGltZW91dEVycm9yLmNvZGUoKSwgVGltZW91dEVycm9yLnczY1N0YXR1cygpKTtcbiAgfVxufVxuXG5jbGFzcyBOb1N1Y2hXaW5kb3dFcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyBjb2RlICgpIHtcbiAgICByZXR1cm4gMjM7XG4gIH1cbiAgY29uc3RydWN0b3IgKGVycikge1xuICAgIHN1cGVyKGVyciB8fCAnQSByZXF1ZXN0IHRvIHN3aXRjaCB0byBhIGRpZmZlcmVudCB3aW5kb3cgY291bGQgbm90IGJlIHNhdGlzZmllZCAnICtcbiAgICAgICAgICAnYmVjYXVzZSB0aGUgd2luZG93IGNvdWxkIG5vdCBiZSBmb3VuZC4nLCBOb1N1Y2hXaW5kb3dFcnJvci5jb2RlKCkpO1xuICB9XG59XG5cbmNsYXNzIEludmFsaWRDb29raWVEb21haW5FcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyBjb2RlICgpIHtcbiAgICByZXR1cm4gMjQ7XG4gIH1cbiAgY29uc3RydWN0b3IgKGVycikge1xuICAgIHN1cGVyKGVyciB8fCAnQW4gaWxsZWdhbCBhdHRlbXB0IHdhcyBtYWRlIHRvIHNldCBhIGNvb2tpZSB1bmRlciBhIGRpZmZlcmVudCAnICtcbiAgICAgICAgICAnZG9tYWluIHRoYW4gdGhlIGN1cnJlbnQgcGFnZS4nLCBJbnZhbGlkQ29va2llRG9tYWluRXJyb3IuY29kZSgpKTtcbiAgfVxufVxuXG5jbGFzcyBOb1N1Y2hDb29raWVFcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyB3M2NTdGF0dXMgKCkge1xuICAgIHJldHVybiBIVFRQU3RhdHVzQ29kZXMuTk9UX0ZPVU5EO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ0NvdWxkIG5vdCBmaW5kIGNvb2tpZScsIG51bGwsIE5vU3VjaENvb2tpZUVycm9yLnczY1N0YXR1cygpKTtcbiAgfVxufVxuXG5jbGFzcyBVbmFibGVUb1NldENvb2tpZUVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAyNTtcbiAgfVxuICBzdGF0aWMgdzNjU3RhdHVzICgpIHtcbiAgICByZXR1cm4gSFRUUFN0YXR1c0NvZGVzLklOVEVSTkFMX1NFUlZFUl9FUlJPUjtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBIHJlcXVlc3QgdG8gc2V0IGEgY29va2llXFwncyB2YWx1ZSBjb3VsZCBub3QgYmUgc2F0aXNmaWVkLicsXG4gICAgICAgICAgVW5hYmxlVG9TZXRDb29raWVFcnJvci5jb2RlKCksIFVuYWJsZVRvU2V0Q29va2llRXJyb3IudzNjU3RhdHVzKCkpO1xuICB9XG59XG5cbmNsYXNzIFVuZXhwZWN0ZWRBbGVydE9wZW5FcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyBjb2RlICgpIHtcbiAgICByZXR1cm4gMjY7XG4gIH1cbiAgc3RhdGljIHczY1N0YXR1cyAoKSB7XG4gICAgcmV0dXJuIEhUVFBTdGF0dXNDb2Rlcy5JTlRFUk5BTF9TRVJWRVJfRVJST1I7XG4gIH1cbiAgY29uc3RydWN0b3IgKGVycikge1xuICAgIHN1cGVyKGVyciB8fCAnQSBtb2RhbCBkaWFsb2cgd2FzIG9wZW4sIGJsb2NraW5nIHRoaXMgb3BlcmF0aW9uJyxcbiAgICAgICAgICBVbmV4cGVjdGVkQWxlcnRPcGVuRXJyb3IuY29kZSgpLCBVbmV4cGVjdGVkQWxlcnRPcGVuRXJyb3IudzNjU3RhdHVzKCkpO1xuICB9XG59XG5cbmNsYXNzIE5vQWxlcnRPcGVuRXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDI3O1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ0FuIGF0dGVtcHQgd2FzIG1hZGUgdG8gb3BlcmF0ZSBvbiBhIG1vZGFsIGRpYWxvZyB3aGVuIG9uZSAnICtcbiAgICAgICAgICAnd2FzIG5vdCBvcGVuLicsIE5vQWxlcnRPcGVuRXJyb3IuY29kZSgpKTtcbiAgfVxufVxuXG5jbGFzcyBTY3JpcHRUaW1lb3V0RXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDI4O1xuICB9XG4gIHN0YXRpYyB3M2NTdGF0dXMgKCkge1xuICAgIHJldHVybiBIVFRQU3RhdHVzQ29kZXMuUkVRVUVTVF9USU1FT1VUO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ0Egc2NyaXB0IGRpZCBub3QgY29tcGxldGUgYmVmb3JlIGl0cyB0aW1lb3V0IGV4cGlyZWQuJyxcbiAgICAgICAgICBTY3JpcHRUaW1lb3V0RXJyb3IuY29kZSgpLCBTY3JpcHRUaW1lb3V0RXJyb3IudzNjU3RhdHVzKCkpO1xuICB9XG59XG5cbmNsYXNzIEludmFsaWRFbGVtZW50Q29vcmRpbmF0ZXNFcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyBjb2RlICgpIHtcbiAgICByZXR1cm4gMjk7XG4gIH1cbiAgY29uc3RydWN0b3IgKGVycikge1xuICAgIHN1cGVyKGVyciB8fCAnVGhlIGNvb3JkaW5hdGVzIHByb3ZpZGVkIHRvIGFuIGludGVyYWN0aW9ucyBvcGVyYXRpb24gYXJlIGludmFsaWQuJyxcbiAgICAgICAgICBJbnZhbGlkRWxlbWVudENvb3JkaW5hdGVzRXJyb3IuY29kZSgpKTtcbiAgfVxufVxuXG5jbGFzcyBJTUVOb3RBdmFpbGFibGVFcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyBjb2RlICgpIHtcbiAgICByZXR1cm4gMzA7XG4gIH1cbiAgY29uc3RydWN0b3IgKGVycikge1xuICAgIHN1cGVyKGVyciB8fCAnSU1FIHdhcyBub3QgYXZhaWxhYmxlLicsIElNRU5vdEF2YWlsYWJsZUVycm9yLmNvZGUoKSk7XG4gIH1cbn1cblxuY2xhc3MgSU1FRW5naW5lQWN0aXZhdGlvbkZhaWxlZEVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAzMTtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdBbiBJTUUgZW5naW5lIGNvdWxkIG5vdCBiZSBzdGFydGVkLicsXG4gICAgICAgICAgSU1FRW5naW5lQWN0aXZhdGlvbkZhaWxlZEVycm9yLmNvZGUoKSk7XG4gIH1cbn1cblxuY2xhc3MgSW52YWxpZFNlbGVjdG9yRXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDMyO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ0FyZ3VtZW50IHdhcyBhbiBpbnZhbGlkIHNlbGVjdG9yIChlLmcuIFhQYXRoL0NTUykuJyxcbiAgICAgICAgICBJbnZhbGlkU2VsZWN0b3JFcnJvci5jb2RlKCkpO1xuICB9XG59XG5cbmNsYXNzIFNlc3Npb25Ob3RDcmVhdGVkRXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDMzO1xuICB9XG4gIHN0YXRpYyB3M2NTdGF0dXMgKCkge1xuICAgIHJldHVybiBIVFRQU3RhdHVzQ29kZXMuSU5URVJOQUxfU0VSVkVSX0VSUk9SO1xuICB9XG4gIGNvbnN0cnVjdG9yIChkZXRhaWxzKSB7XG4gICAgbGV0IG1lc3NhZ2UgPSAnQSBuZXcgc2Vzc2lvbiBjb3VsZCBub3QgYmUgY3JlYXRlZC4nO1xuICAgIGlmIChkZXRhaWxzKSB7XG4gICAgICBtZXNzYWdlICs9IGAgRGV0YWlsczogJHtkZXRhaWxzfWA7XG4gICAgfVxuXG4gICAgc3VwZXIobWVzc2FnZSwgU2Vzc2lvbk5vdENyZWF0ZWRFcnJvci5jb2RlKCksIFNlc3Npb25Ob3RDcmVhdGVkRXJyb3IudzNjU3RhdHVzKCkpO1xuICB9XG59XG5cbmNsYXNzIE1vdmVUYXJnZXRPdXRPZkJvdW5kc0Vycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAzNDtcbiAgfVxuICBzdGF0aWMgdzNjU3RhdHVzICgpIHtcbiAgICByZXR1cm4gNTAwO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ1RhcmdldCBwcm92aWRlZCBmb3IgYSBtb3ZlIGFjdGlvbiBpcyBvdXQgb2YgYm91bmRzLicsXG4gICAgICAgICAgTW92ZVRhcmdldE91dE9mQm91bmRzRXJyb3IuY29kZSgpLCBNb3ZlVGFyZ2V0T3V0T2ZCb3VuZHNFcnJvci53M2NTdGF0dXMoKSk7XG4gIH1cbn1cblxuY2xhc3MgTm9TdWNoQ29udGV4dEVycm9yIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIGNvZGUgKCkge1xuICAgIHJldHVybiAzNTtcbiAgfVxuICBjb25zdHJ1Y3RvciAoZXJyKSB7XG4gICAgc3VwZXIoZXJyIHx8ICdObyBzdWNoIGNvbnRleHQgZm91bmQuJywgTm9TdWNoQ29udGV4dEVycm9yLmNvZGUoKSk7XG4gIH1cbn1cblxuY2xhc3MgSW52YWxpZENvbnRleHRFcnJvciBleHRlbmRzIE1KU09OV1BFcnJvciB7XG4gIHN0YXRpYyBjb2RlICgpIHtcbiAgICByZXR1cm4gMzY7XG4gIH1cbiAgY29uc3RydWN0b3IgKGVycikge1xuICAgIHN1cGVyKGVyciB8fCAnVGhhdCBjb21tYW5kIGNvdWxkIG5vdCBiZSBleGVjdXRlZCBpbiB0aGUgY3VycmVudCBjb250ZXh0LicsXG4gICAgICAgICAgSW52YWxpZENvbnRleHRFcnJvci5jb2RlKCkpO1xuICB9XG59XG5cbmNsYXNzIE5vdFlldEltcGxlbWVudGVkRXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDEzO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ01ldGhvZCBoYXMgbm90IHlldCBiZWVuIGltcGxlbWVudGVkJywgTm90WWV0SW1wbGVtZW50ZWRFcnJvci5jb2RlKCkpO1xuICB9XG59XG5cbmNsYXNzIE5vdEltcGxlbWVudGVkRXJyb3IgZXh0ZW5kcyBNSlNPTldQRXJyb3Ige1xuICBzdGF0aWMgY29kZSAoKSB7XG4gICAgcmV0dXJuIDEzO1xuICB9XG4gIGNvbnN0cnVjdG9yIChlcnIpIHtcbiAgICBzdXBlcihlcnIgfHwgJ01ldGhvZCBpcyBub3QgaW1wbGVtZW50ZWQnLCBOb3RJbXBsZW1lbnRlZEVycm9yLmNvZGUoKSk7XG4gIH1cbn1cblxuY2xhc3MgVW5hYmxlVG9DYXB0dXJlU2NyZWVuIGV4dGVuZHMgTUpTT05XUEVycm9yIHtcbiAgc3RhdGljIHczY1N0YXR1cyAoKSB7XG4gICAgcmV0dXJuIEhUVFBTdGF0dXNDb2Rlcy5JTlRFUk5BTF9TRVJWRVJfRVJST1I7XG4gIH1cbiAgY29uc3RydWN0b3IgKGVycikge1xuICAgIHN1cGVyKGVyciB8fCAnVW5hYmxlIHRvIGNhcHR1cmUgc2NyZWVuJywgbnVsbCwgVW5hYmxlVG9DYXB0dXJlU2NyZWVuLnczY1N0YXR1cygpKTtcbiAgfVxufVxuXG5cblxuY2xhc3MgQmFkUGFyYW1ldGVyc0Vycm9yIGV4dGVuZHMgRVM2RXJyb3Ige1xuICBjb25zdHJ1Y3RvciAocmVxdWlyZWRQYXJhbXMsIGFjdHVhbFBhcmFtcywgZXJyTWVzc2FnZSkge1xuICAgIGxldCBtZXNzYWdlO1xuICAgIGlmICghZXJyTWVzc2FnZSkge1xuICAgICAgbWVzc2FnZSA9IGBQYXJhbWV0ZXJzIHdlcmUgaW5jb3JyZWN0LiBXZSB3YW50ZWQgYCArXG4gICAgICAgICAgYCR7SlNPTi5zdHJpbmdpZnkocmVxdWlyZWRQYXJhbXMpfSBhbmQgeW91IGAgK1xuICAgICAgICAgIGBzZW50ICR7SlNPTi5zdHJpbmdpZnkoYWN0dWFsUGFyYW1zKX1gO1xuICAgIH0gZWxzZSB7XG4gICAgICBtZXNzYWdlID0gYFBhcmFtZXRlcnMgd2VyZSBpbmNvcnJlY3QuIFlvdSBzZW50ICR7SlNPTi5zdHJpbmdpZnkoYWN0dWFsUGFyYW1zKX0sICR7ZXJyTWVzc2FnZX1gO1xuICAgIH1cbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLnczY1N0YXR1cyA9IEhUVFBTdGF0dXNDb2Rlcy5CQURfUkVRVUVTVDtcbiAgfVxufVxuXG4vKipcbiAqIFByb3h5UmVxdWVzdEVycm9yIGlzIGEgY3VzdG9tIGVycm9yIGFuZCB3aWxsIGJlIHRocm93biB1cCBvbiB1bnN1Y2Nlc3NmdWwgcHJveHkgcmVxdWVzdCBhbmRcbiAqIHdpbGwgY29udGFpbiBpbmZvcm1hdGlvbiBhYm91dCB0aGUgcHJveHkgZmFpbHVyZS5cbiAqIEluIGNhc2Ugb2YgUHJveHlSZXF1ZXN0RXJyb3Igc2hvdWxkIGZldGNoIHRoZSBhY3R1YWwgZXJyb3IgYnkgY2FsbGluZyBgZ2V0QWN0dWFsRXJyb3IoKWBcbiAqIGZvciBwcm94eSBmYWlsdXJlIHRvIGdlbmVyYXRlIHRoZSBjbGllbnQgcmVzcG9uc2UuXG4gKi9cbmNsYXNzIFByb3h5UmVxdWVzdEVycm9yIGV4dGVuZHMgRVM2RXJyb3Ige1xuICBjb25zdHJ1Y3RvciAoZXJyLCBqc29ud3ApIHtcbiAgICBsZXQgbWVzc2FnZSA9IGBQcm94eSByZXF1ZXN0IHVuc3VjY2Vzc2Z1bC4gJHt1dGlsLmhhc1ZhbHVlKGpzb253cCkgPyBqc29ud3AudmFsdWUgOiAnJ31gO1xuICAgIHN1cGVyKGVyciB8fCBtZXNzYWdlKTtcbiAgICB0aGlzLnczY1N0YXR1cyA9IEhUVFBTdGF0dXNDb2Rlcy5CQURfUkVRVUVTVDtcbiAgICBpZiAodHlwZW9mIGpzb253cCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMuanNvbndwID0gSlNPTi5wYXJzZShqc29ud3ApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmpzb253cCA9IGpzb253cDtcbiAgICB9XG4gIH1cblxuICBnZXRBY3R1YWxFcnJvciAoKSB7XG4gICAgaWYgKHV0aWwuaGFzVmFsdWUodGhpcy5qc29ud3ApICYmIHV0aWwuaGFzVmFsdWUodGhpcy5qc29ud3Auc3RhdHVzKSAmJiB1dGlsLmhhc1ZhbHVlKHRoaXMuanNvbndwLnZhbHVlKSkge1xuICAgICAgLy9yZXR1cm5zIGFjdHVhbCBlcnJvciBjYXVzZSBmb3IgcmVxdWVzdCBmYWlsdXJlIGJhc2VkIG9uIGBqc29ud3Auc3RhdHVzYFxuICAgICAgcmV0dXJuIGVycm9yRnJvbUNvZGUodGhpcy5qc29ud3Auc3RhdHVzLCB0aGlzLmpzb253cC52YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgVW5rbm93bkVycm9yKHRoaXMubWVzc2FnZSk7XG4gIH1cbn1cbi8vIG1hcCBvZiBlcnJvciBjbGFzcyBuYW1lIHRvIGVycm9yIGNsYXNzXG5jb25zdCBlcnJvcnMgPSB7Tm90WWV0SW1wbGVtZW50ZWRFcnJvcixcbiAgICAgICAgICAgICAgICBOb3RJbXBsZW1lbnRlZEVycm9yLFxuICAgICAgICAgICAgICAgIEJhZFBhcmFtZXRlcnNFcnJvcixcbiAgICAgICAgICAgICAgICBOb1N1Y2hEcml2ZXJFcnJvcixcbiAgICAgICAgICAgICAgICBOb1N1Y2hFbGVtZW50RXJyb3IsXG4gICAgICAgICAgICAgICAgVW5rbm93bkNvbW1hbmRFcnJvcixcbiAgICAgICAgICAgICAgICBTdGFsZUVsZW1lbnRSZWZlcmVuY2VFcnJvcixcbiAgICAgICAgICAgICAgICBFbGVtZW50Tm90VmlzaWJsZUVycm9yLFxuICAgICAgICAgICAgICAgIEludmFsaWRFbGVtZW50U3RhdGVFcnJvcixcbiAgICAgICAgICAgICAgICBVbmtub3duRXJyb3IsXG4gICAgICAgICAgICAgICAgRWxlbWVudElzTm90U2VsZWN0YWJsZUVycm9yLFxuICAgICAgICAgICAgICAgIEphdmFTY3JpcHRFcnJvcixcbiAgICAgICAgICAgICAgICBYUGF0aExvb2t1cEVycm9yLFxuICAgICAgICAgICAgICAgIFRpbWVvdXRFcnJvcixcbiAgICAgICAgICAgICAgICBOb1N1Y2hXaW5kb3dFcnJvcixcbiAgICAgICAgICAgICAgICBOb1N1Y2hDb29raWVFcnJvcixcbiAgICAgICAgICAgICAgICBJbnZhbGlkQ29va2llRG9tYWluRXJyb3IsXG4gICAgICAgICAgICAgICAgVW5hYmxlVG9TZXRDb29raWVFcnJvcixcbiAgICAgICAgICAgICAgICBVbmV4cGVjdGVkQWxlcnRPcGVuRXJyb3IsXG4gICAgICAgICAgICAgICAgTm9BbGVydE9wZW5FcnJvcixcbiAgICAgICAgICAgICAgICBTY3JpcHRUaW1lb3V0RXJyb3IsXG4gICAgICAgICAgICAgICAgSW52YWxpZEVsZW1lbnRDb29yZGluYXRlc0Vycm9yLFxuICAgICAgICAgICAgICAgIElNRU5vdEF2YWlsYWJsZUVycm9yLFxuICAgICAgICAgICAgICAgIElNRUVuZ2luZUFjdGl2YXRpb25GYWlsZWRFcnJvcixcbiAgICAgICAgICAgICAgICBJbnZhbGlkU2VsZWN0b3JFcnJvcixcbiAgICAgICAgICAgICAgICBTZXNzaW9uTm90Q3JlYXRlZEVycm9yLFxuICAgICAgICAgICAgICAgIE1vdmVUYXJnZXRPdXRPZkJvdW5kc0Vycm9yLFxuICAgICAgICAgICAgICAgIE5vU3VjaENvbnRleHRFcnJvcixcbiAgICAgICAgICAgICAgICBJbnZhbGlkQ29udGV4dEVycm9yLFxuICAgICAgICAgICAgICAgIE5vU3VjaEZyYW1lRXJyb3IsXG4gICAgICAgICAgICAgICAgVW5hYmxlVG9DYXB0dXJlU2NyZWVuLFxuICAgICAgICAgICAgICAgIFVua25vd25NZXRob2RFcnJvcixcbiAgICAgICAgICAgICAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkVycm9yLFxuICAgICAgICAgICAgICAgIFByb3h5UmVxdWVzdEVycm9yfTtcblxuLy8gbWFwIG9mIGVycm9yIGNvZGUgdG8gZXJyb3IgY2xhc3NcbmNvbnN0IGVycm9yQ29kZU1hcCA9IHt9O1xuZm9yIChsZXQgRXJyb3JDbGFzcyBvZiBfLnZhbHVlcyhlcnJvcnMpKSB7XG4gIGlmIChFcnJvckNsYXNzLmNvZGUpIHtcbiAgICBlcnJvckNvZGVNYXBbRXJyb3JDbGFzcy5jb2RlKCldID0gRXJyb3JDbGFzcztcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0Vycm9yVHlwZSAoZXJyLCB0eXBlKSB7XG4gIC8vIGBuYW1lYCBwcm9wZXJ0eSBpcyB0aGUgY29uc3RydWN0b3IgbmFtZVxuICBpZiAodHlwZS5uYW1lID09PSBNSlNPTldQRXJyb3IubmFtZSkge1xuICAgIC8vIGBqc29ud3BDb2RlYCBpcyBgMGAgb24gc3VjY2Vzc1xuICAgIHJldHVybiAhIWVyci5qc29ud3BDb2RlO1xuICB9IGVsc2UgaWYgKHR5cGUubmFtZSA9PT0gUHJveHlSZXF1ZXN0RXJyb3IubmFtZSkge1xuICAgIC8vIGBzdGF0dXNgIGlzIGAwYCBvbiBzdWNjZXNzXG4gICAgbGV0IGhhc0pzb253cE9iaiA9ICEhZXJyLmpzb253cDtcbiAgICBpZiAoaGFzSnNvbndwT2JqKSB7XG4gICAgICByZXR1cm4gISFlcnIuanNvbndwLnN0YXR1cztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZXJyLmNvbnN0cnVjdG9yLm5hbWUgPT09IHR5cGUubmFtZTtcbn1cblxuLy8gcmV0cmlldmUgYW4gZXJyb3Igd2l0aCB0aGUgY29kZSBhbmQgbWVzc2FnZVxuZnVuY3Rpb24gZXJyb3JGcm9tQ29kZSAoY29kZSwgbWVzc2FnZSkge1xuICBpZiAoY29kZSAhPT0gMTMgJiYgZXJyb3JDb2RlTWFwW2NvZGVdKSB7XG4gICAgcmV0dXJuIG5ldyBlcnJvckNvZGVNYXBbY29kZV0obWVzc2FnZSk7XG4gIH1cbiAgcmV0dXJuIG5ldyBVbmtub3duRXJyb3IobWVzc2FnZSk7XG59XG5cbmV4cG9ydCB7IE1KU09OV1BFcnJvciwgZXJyb3JzLCBpc0Vycm9yVHlwZSwgZXJyb3JGcm9tQ29kZSB9O1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
